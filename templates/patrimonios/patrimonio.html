{% extends 'base.html' %}
{% load static %}

{% block title %}
Patrimônio
{% endblock title %}


{% block scripts %}
<script>
    let img = '{% static "img/baeeckground.png" %}';
    $('#pesquisaPatrimonio').click(function(){
        let query = $('#query').val();
        if(query.length >= 2 ){
            $.ajax({
                type: 'GET',
                url: '{% url "patrimonio_view" %}',
                data: {
                    'query': query,
                },
                beforeSend: function(){
                    $('#headTabela').remove();
                },
                success: function(data){
                    let items = data['items']
                    if(items.length >=1){
                        $('#msgerro').remove()
                        $('#divTable').append('<thead id="headTabela"><th scope="col">Patrimônio</th><th scope="col">Tipo</th><th scope="col">Departamento</th><th scope="col">Estado</th></thead>')
                        $('#modificar').html(items)
                        $('#divTabela').css('background-image', 'none')
                    }else {
                        $('#msgerro').remove()
                        $('#modificar').html('')
                        $('#divTabela').css('background-image', 'url({% static "img/baeeckground.png" %})')
                        $('#divTabela').append('<div id="msgerro" class="d-flex justify-content-center d-flex align-items-center pt-1"><p class="text-muted">Nada Encontrado!</p></div>')
                    }
                },
                error: function(request, status, error){
                    alert('erro!')
                }
            });
        }
    });
</script>
{% endblock scripts %}

{% block corpo %}
<style>
    body {
        background-color:rgb(235, 232, 232);
        border-style:none;
        background-image:  linear-gradient(#bdc3c7, #a6aeb4);
        
    }
    tbody > td {
        color:white;
    }

    #divTabela {
        background-image: url('{% static "img/baeeckground.png" %}');
        background-position: center;
        background-repeat: no-repeat;
    }
</style>

<main id="primeiro">
    <div class="container bg-dark text-light p-2 p-lg-5 rounded mb-5">
        <div class="row">
            
            <div class="col-12 col-lg-12 text-muted">
                <!-- <h5 class='pb-2'>
                    <i class="fas fa-search pe-2"></i>
                    Consultar Patrimônios</h5> -->
                <div class="input-group pt-2">
                    <input type="search" class='form-control rounded bg-dark border-secondary text-light' placeholder="Pesquisa" aria-label="Search" aria-labelledby="search-addon" id='query' autocomplete="off">
                    <button class="btn btn-outline-primary" id='pesquisaPatrimonio'>Pesquisar</button>
                </div>
                <div id='divTabela' style='min-height: 20vh; max-height: 50vh;' class="col-12 mt-3 overflow-auto">
                    
                    <table class="table table-sm text-center table table-striped text-light text-muted border-0" id="divTable">
                        
                        <tbody class='text-muted' id='modificar'>
                            
                        </tbody>
                        
                    </table>
                    <div id="msgerro" class="d-flex justify-content-center d-flex align-items-center pt-1"><p class="text-muted">Nada Encontrado!</p></div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock corpo %}